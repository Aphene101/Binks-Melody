import{g as m,a as f,s as h,b as c,c as g,d as w,e as y,f as p}from"./firebase-DoM9rtEd.js";import"./main-D917LwOw.js";const v=m(),E=f(v);function b(e){switch(e.code||e.message){case"auth/invalid-email":return"Please enter a valid email address.";case"auth/user-not-found":return"No account found with this email or username.";case"auth/invalid-credential":return"Email / Password is incorrect.";case"auth/user-disabled":return"This account has been disabled.";case"auth/email-not-verified":return"Please verify your email before logging in.";case"auth/too-many-requests":return"Too many failed attempts. Please try again later.";default:return e.message||"Something went wrong. Please try again."}}async function l(e){if(e.includes("@"))return e;const r=y(E,"usernames",e),a=await p(r);if(a.exists())return a.data().email;throw new Error("Username not found")}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#login-email"),r=document.querySelector("#login-password"),a=document.querySelector("#login-button"),s=document.querySelector("#login-error"),d=document.getElementById("forgot-password");!e||!r||!a||!s||(a.addEventListener("click",async()=>{const i=e.value.trim(),t=r.value;if(!i||!t){s.textContent="Please enter both fields.";return}try{const n=await l(i);if(!(await h(c,n,t)).user.emailVerified)throw await g(c),{code:"auth/email-not-verified"};s.textContent="",window.location.href="./home.html"}catch(n){console.error("Login error:",n);const o=b(n);s.textContent=o}}),d?.addEventListener("click",async i=>{i.preventDefault();try{let t=e?.value?.trim();if(t||(t=window.prompt("Enter the email (or username) for your account:")?.trim()),!t)return;let n=t;if(!t.includes("@"))try{n=await l(t)}catch{}const o=new URL("/Binks-Melody/reset.html",window.location.origin).toString(),u={url:o,handleCodeInApp:!0};await w(c,n,{url:o,handleCodeInApp:!1}),alert("If that account exists, a reset link has been sent.")}catch(t){console.error(t),alert("If that account exists, a reset link has been sent.")}}))});
