import{b as i,m as u,o as m,c as y,q as g,h as p,i as v,w as f,j as h}from"./firebase-CkxRimO6.js";document.addEventListener("DOMContentLoaded",function(){console.log("main.js loaded");const e=document.querySelector(".guest"),t=document.querySelector(".sidebar"),r=document.getElementById("newPlaylistBtn"),c=document.querySelector(".add-playlist"),n=document.createElement("div"),d=document.getElementById("createPlaylistBtn")||null,l=document.getElementById("playlistNameInput")||null;n.className="overlay",document.body.appendChild(n),e?.addEventListener("click",function(){t.classList.toggle("show"),n.classList.toggle("active"),document.body.style.overflow=t.classList.contains("show")?"hidden":"auto"}),n.addEventListener("click",function(){const o=t?.classList.contains("show"),a=c?.classList.contains("show");o&&t.classList.remove("show"),a&&c.classList.remove("show"),(o||a)&&(n.classList.remove("active"),document.body.style.overflow="auto")}),r?.addEventListener("click",()=>{c.classList.add("show"),n.classList.add("active"),document.body.style.overflow="hidden"}),t?.addEventListener("click",o=>o.stopPropagation()),c?.addEventListener("click",o=>o.stopPropagation()),d?.addEventListener("click",async()=>{const o=(l?.value||"").trim();if(!o)return;const a=i.currentUser?.uid;if(console.log("auth.currentUser:",i?.currentUser),!a){alert("You need to be logged in to create a playlist.");return}await u(a,o),c.classList.remove("show"),l.value="",location.reload()})});const s=document.querySelector(".guest p")||null;m(i,async e=>{if(s&&(s.textContent="Guest"),e)try{const t=g(p(v,"usernames"),f("userId","==",e.uid)),r=await h(t);if(r.empty)console.warn("No username found for user UID:",e.uid),s&&(s.textContent="Guest");else{const n=r.docs[0].id;s.textContent=n}}catch(t){console.error("Error fetching username:",t),s&&(s.textContent="Guest")}else s&&(s.textContent="Guest"),console.log("No user is logged in.")});document.querySelector(".logout")?.addEventListener("click",async()=>{try{await y(i);const e=document.querySelector(".guest p");e&&(e.textContent="Guest")}catch(e){console.error("Error signing out:",e)}});
