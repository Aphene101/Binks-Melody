import{d as i,a as o,g as y,c as E,b as d,s as l,e as I,f as h,h as v,i as x}from"./main-BsRMFtTf.js";document.addEventListener("DOMContentLoaded",()=>{const c=document.getElementById("sign-up-form"),m=document.getElementById("sign-up-username"),g=document.getElementById("sign-up-email"),p=document.getElementById("sign-up-password"),s=document.getElementById("sign-up-error");c.addEventListener("submit",async f=>{f.preventDefault();const r=m.value.trim(),n=g.value.trim(),u=p.value;if(!r||!n||!u){s.textContent="All fields are required.";return}const w=i(o,"usernames",r);if((await y(w)).exists()){s.textContent="Username is already taken.";return}let t;try{t=await E(d,n,u);const e=t.user,a=e.uid;await l(i(o,"usernames",r),{email:n,userId:a}),await l(i(o,"users",a),{}),await I(e),await h(a),await v(d),alert("Account created! Please verify your email before logging in."),setTimeout(()=>{window.location.href="./index.html"},500)}catch(e){if(console.error("Signup error:",e),t&&t.user)try{await x(t.user),console.log("Deleted partially registered user due to error.")}catch(a){console.warn("Could not delete user after failed signup:",a)}e.code==="auth/email-already-in-use"?s.textContent="This email is already registered.":s.textContent=e.message||"Signup failed."}})});
